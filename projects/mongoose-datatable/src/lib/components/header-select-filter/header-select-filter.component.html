@if (selectControl) {
<mat-form-field appearance="fill">
  <mat-label [innerHTML]="column.header"></mat-label>
  <mat-select [formControl]="selectControl">
    @let options = $any(column.options | async);

    <mat-select-trigger>
      @let option = selectControl.value | selectOption:options;
      @if (option) {
      <ng-container *ngTemplateOutlet="selectOption; context: { option }"></ng-container>
      } @else {
      <mat-label [innerHTML]="selectControl.value"></mat-label>
      }
    </mat-select-trigger>
    @for (option of options; track option) {
    <mat-option [value]="option.value">
      <ng-container *ngTemplateOutlet="selectOption; context: { option }"></ng-container>
    </mat-option>
    }
  </mat-select>
</mat-form-field>
}

<ng-template #selectOption let-option="option">
  <div class="option">
    @if (option.icon) {
    <mat-icon [style.color]="option.iconColor" [style.margin-right.px]="8">
      {{option.icon}}
    </mat-icon>
    }
    <mat-label [style.color]="option.color" [innerHTML]="option.label"></mat-label>
  </div>
</ng-template>
